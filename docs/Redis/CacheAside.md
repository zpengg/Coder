# CacheAside

读 --> 缓存 --fallback--> 数据库 --放回--> 缓存 --> 返回
写 --> 数据库 --> 删缓存

## [X] 先删缓存再操作数据库 不一致
删除期间，其他读取出，导致与更新后不一致
影响最终一致性

## 基本策略：先改数据库再删缓存
用于缓存**非频繁访问**场景

### 可能删缓存失败
重试可保证最终一致

### 数据库主从 缓存从从库读到旧数据  导致不一致
- 选择性读主 （过于复杂)
- **定时更新 （简单）**


### 删 比 改 好？
Lazy 思想， 写多读少的情况下，减少修改次数

## 兜底：定时刷新 保证最终一致

## 进程内缓存
### 多机不一致
- 单点读 + 广播，耦合
- 单点读 + MQ， 增加了MQ 更复杂
- **多点定时刷新缓存， 简单，最终一致**

### 使用时机
- 只读
- 极高并发
- 一定程度上允许不一致。


